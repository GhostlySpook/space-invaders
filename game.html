<canvas id="gameCanvas" width="800" height="600"></canvas>
<button id="startButton" onClick="restartGame()">Restart Game</button>
<script>
    //Define canvas
    var gameCanvas = document.getElementById("gameCanvas");
    var ctx = gameCanvas.getContext("2d");
    
    //Load images
    var imgAlien = new Image();
    //imgAlien.src = "http://s3.amazonaws.com/gt7sp-prod/decal/76/67/97/4621335403474976776_1.png";
    imgAlien.src = "Invader.png";

    var imgDefender = new Image();
    //imgDefender.src = "https://pixelartmaker-data-78746291193.nyc3.digitaloceanspaces.com/image/e4af22756166f44.png";
    imgDefender.src = "Defender.png";

    var imgProjectile = new Image();
    imgProjectile.src = "Bullet.png";

    var imgEnemyProjectile = new Image();
    imgEnemyProjectile.src = "EnemyProjectile.png";

    var imgUFO = new Image();
    imgUFO.src = "UFO.png";

    var imgShield = new Image();
    imgShield.src = "Shield.png";

    var imgExplosion = new Image();
    imgExplosion.src = "Explosion.png";

    var imgAlienExplosion = new Image();
    imgAlienExplosion.src = "EnemyExplosion.png";

    //////////////////////////////////
    //Game parameters
    //var gameStarted = 0;
    var fractions = 60;
    var timeFraction = 1000 / fractions;
    var screenWidth = 800;
    var screenHeight = 600;

    var defaultLives = 3;
    var defaultHighscore = 1000;
    
    //Player settings
    var playerSpeed = 4;
    var playerInitialPosX = 385;
    var playerInitialPosY = 530;
    var playerLimitXLeft = 50;
    var playerLimitXRight = 750;

    var playerHeight = 20;
    var playerWidth = 40;

    var playerProjectileHeight = 20;
    var playerProjectileWidth = 2;
    var maxPlayerProjectiles = 1;
    var playerProjectileReloadTime = 30;
    var playerProjectileSpeed = 10;
    var playerProjectileYLimit = 50;

    //Alien settings
    var alienRows = 5;
    var alienColumns = 11;

    var alienHeight = 22;
    var alienWidth = 45;
    var alienDirection = 1;
    var alienXMoveDistance = 7;
    var alienYMoveDistance = 10;
    var alienDefaultFPSForMovement = 12;
    var alienDefaultFPSForProjectile = 120;

    var alienReduceFPSWaitPercentage = 0.97;

    var alienXLimitLeft = 50;
    var alienXLimitRight = 750;
    var alienXSeparation = 10;
    var alienYSeparation = 15;
    var alienYStart = 100;

    var alienPoints = 10;

    //UFO settings
    var UFOSpeed = 3;
    var UFOPoints = 50;
    var UFOFramesForSpawn = fractions * 30; //FPS of game times the seconds each UFO takes to spawn
    var UFOWidth = 50;
    var UFOHeight = 20;
    var UFOXLeftLimit = 0; //Disappear once the left part touches the edge
    var UFOXRightLimit = screenWidth; //UFO should disappear once the right part touches the limit
    var UFOYSpawn = 60;
    const UFODirections = {
        RIGHT: 0,
        LEFT: 1
    }

    //Enemy projectile settings
    var enemyProjectileSpeed = 5;
    var enemyProjectileChance = 1;
    var enemyMaxProjectiles = 5;

    var enemyProjectileHeight = 20;
    var enemyProjectileWidth = 8;

    //Shield settings
    var defaultShields = 4;
    var defaultShieldHealth = 5;
    var defaultShieldWidth = 90;
    var defaultShieldHeight = 40;
    var defaultShieldPosY = 450;

    //Temp Sprites settings
    //Explosions take the same time it takes for your projectile to disappear
    var tempSpriteExplosionWidth = alienWidth;
    var tempSpriteExplosionHeight = alienHeight;
    var tempSpriteExplosionDuration = playerProjectileReloadTime;

    var tempSpriteEnemyExplosionWidth = alienWidth;
    var tempSpriteEnemyExplosionHeight = alienHeight;
    var tempSpriteEnemyExplosionDuration = playerProjectileReloadTime;

    //End of parameters

    //Start loop
    var gameInterval;

    var score = 0;
    var highScore = defaultHighscore;
    
    var lives = defaultLives;
    var playerPosX = playerInitialPosX;
    var playerPosY = playerInitialPosY;
    var playerProjectileList = [];
    var playerProjectileCurrentReload = 0;

    var keyLeft = false;
    var keyRight = false;
    var keyShoot = false;

    var alienList = [];
    var alienX = 0;
    var alienY = alienYStart;
    var alienMovementFPS = 0;
    var alienAcceleratedFPS = alienDefaultFPSForMovement;
    var alienFlagDirection = false;
    var alienReadyChangeDirection = false;
    var alienMovementRows = [];
    var alienCurrentMovementIndex = 0;
    var bottomAliens = [];

    var enemyProjectileList = [];
    var alienProjectileFPS = 0;

    var UFOCountSpawnFPS = 0;
    var UFOList = [];

    var shieldList = [];

    var tempSpriteList = [];

    var gameLoop = () => {
        //Reduce reload waiting time
        if(playerProjectileCurrentReload >= 0){
            playerProjectileCurrentReload--;
        }

        drawItems();

        //Check input and handle it
        if(keyLeft == true){
            if((playerPosX - playerSpeed) >= playerLimitXLeft){
                playerPosX -= playerSpeed;
            }
        }
        if(keyRight == true){
            if((playerPosX + playerWidth + playerSpeed) <= playerLimitXRight){
                playerPosX += playerSpeed;
            }
        }
        if(keyShoot == true){
            if(playerProjectileList.length < maxPlayerProjectiles && shotInputReleased == true){
                //Shoot projectile
                //Center projectile based on player
                let centerPlayerX = playerPosX + (playerWidth / 2);
                let projectileX = centerPlayerX - (playerProjectileWidth / 2);

                let projectile = {
                    posX: projectileX,
                    posY: playerPosY,
                    width: playerProjectileWidth,
                    height: playerProjectileHeight 
                };

                playerProjectileList.push(projectile);
            }
            shotInputReleased = false;
        }
        else if(keyShoot == false){
            shotInputReleased = true;
        }
        
        //Move aliens when the time arrives and there ARE aliens
        if(alienAcceleratedFPS <= alienMovementFPS && alienList.length > 0){
            //console.log("Current alien direction: ", alienDirection)
            //console.log("Alien moving row: ", alienCurrentMovementIndex);
            listLength = alienList.length;
            let lastRow = alienMovementRows[(alienMovementRows.length - 1)]

            if(alienReadyChangeDirection){
                if((alienMovementRows.length - 1) == alienCurrentMovementIndex){
                    alienDirection *= -1;
                }

                for(let alienNo = 0; alienNo < listLength; alienNo++){
                    if(alienList[alienNo].row == alienMovementRows[alienCurrentMovementIndex]){
                        alienList[alienNo].posX += alienDirection * alienXMoveDistance;
                        alienList[alienNo].posY += alienYMoveDistance;
                    }

                    if((alienList[alienNo].posX + alienList[alienNo].width > alienXLimitRight || alienList[alienNo].posX < alienXLimitLeft)){
                        alienFlagDirection = true;
                    }

                    if(alienCurrentMovementIndex == 0){
                        alienFlagDirection = false;
                        alienReadyChangeDirection = false;
                    }
                }
            }
            else{
                
                for(let alienNo = 0; alienNo < listLength; alienNo++){
                    if(alienList[alienNo].row == alienMovementRows[alienCurrentMovementIndex]){
                        alienList[alienNo].posX += alienDirection * alienXMoveDistance;
                    }

                    if((alienList[alienNo].posX + alienList[alienNo].width > alienXLimitRight || alienList[alienNo].posX < alienXLimitLeft)){
                        alienFlagDirection = true;
                    }
                }
            }

            if(alienCurrentMovementIndex == 0 && alienFlagDirection == true){
                alienReadyChangeDirection = true;
            }

            alienMovementFPS = 0;

            alienCurrentMovementIndex--;
            if(alienCurrentMovementIndex < 0){
                alienCurrentMovementIndex = alienMovementRows.length - 1;
            }
        }
        else{
            alienMovementFPS++;
        }

        //Check alien collision
        //TODO
            //Check collision with shield
            //TODO
            //Check collision with player
            //TODO

        //Create UFOs
        if(UFOCountSpawnFPS >= UFOFramesForSpawn){
            //console.log("Created UFO!");
            //Choose whether the UFO moves to the left or to the right
            let direction = Math.floor(Math.random() * 2);

            //If the direction is to go right
            if(direction == UFODirections.RIGHT){
                //Spawn on the left side
                posX = UFOXLeftLimit;
            }
            else{
                posX = UFOXRightLimit;
            }

            let newUFO = {
                direction: direction,
                width: UFOWidth,
                height: UFOHeight,
                posX: posX,
                posY: UFOYSpawn
            }

            UFOList.push(newUFO);

            UFOCountSpawnFPS = 0;
        }
        else{
            UFOCountSpawnFPS++;
        }
        
        //Move UFOS
        for(let i = 0; i < UFOList.length; i++){
            let currentUFO = UFOList[i];

            //When the UFO is going right
            if(currentUFO.direction == UFODirections.RIGHT){
                //Do the movement
                currentUFO.posX += UFOSpeed;
            
                //Check if the UFO has reached the limit (Check the direction it is going). This case, if it reached the right side
                if(currentUFO.posX + currentUFO.width >= UFOXRightLimit){
                    //Delete the UFO! in the current position
                    UFOList.splice(i, 1);
                    i--;
                    continue
                }
            }
            else{
                //Same to case above
                currentUFO.posX -= UFOSpeed;

                if(currentUFO.posX <= UFOXLeftLimit){
                    //Delete the UFO! in the current position
                    UFOList.splice(i, 1);
                    i--;
                    continue
                }
            }
        }

        //Create enemy projectiles
        if(alienDefaultFPSForProjectile <= alienProjectileFPS && alienList.length > 0){
            listLength = alienList.length;

            //Select a random alien from the bottom and shoot
            let randomAlien = bottomAliens[Math.floor(Math.random() * bottomAliens.length)];

            let projectileX = randomAlien.posX + (randomAlien.width / 2);

            let enemyProjectile = {
                posX: projectileX,
                posY: (randomAlien.posY + randomAlien.height),
                width: enemyProjectileWidth,
                height: enemyProjectileHeight
            };
            enemyProjectileList.push(enemyProjectile);

            alienProjectileFPS = 0;
        }
        else{
            alienProjectileFPS++;
        }
        
        //Move friendly projectile
        let playerProjectileListLength = playerProjectileList.length;
        for(let i = 0; i < playerProjectileListLength; i++){
            let currentProjectile = playerProjectileList[i];
            currentProjectile.posY -= playerProjectileSpeed;
        }

        //Move enemy projectile
        let enemyProjectileLength = enemyProjectileList.length;
        for(let i = 0; i < enemyProjectileLength; i++){
            let currentProjectile = enemyProjectileList[i];
            currentProjectile.posY += enemyProjectileSpeed;
        }

        //Check collision on player projectile
        for(let projectileNo = 0; projectileNo < playerProjectileList.length; projectileNo++){
            let removeProjectile = false;

            let currentProjectile = playerProjectileList[projectileNo];

            //Check if projectile hits shield

            for(let shieldNo = 0; shieldNo < shieldList.length; shieldNo++){
                let currentShield = shieldList[shieldNo];

                //Projectile hits shield
                if(checkCollision(currentProjectile.posX, currentProjectile.width, 
                currentProjectile.posY, currentProjectile.height, 
                currentShield.posX, currentShield.width, 
                currentShield.posY, currentShield.height)){
                        currentShield.health--;

                        if(currentShield.health <= 0){
                            shieldList.splice(shieldNo, 1);
                            //Creo que no se ocupa al ser destruido el proyectil
                            //shieldNo--;
                        }

                        removeProjectile = true;
                        break;
                }

            }

            if(removeProjectile){
                playerProjectileList.splice(projectileNo, 1);
                projectileNo--;
                continue;
            }

            //Check if projectile hits alien
            for(let alienNo = 0; alienNo < alienList.length; alienNo++){
                //console.log(alienNo);
                let currentAlien = alienList[alienNo];

                //Check if alien was hit!
                if(checkCollision(currentProjectile.posX, currentProjectile.width, 
                currentProjectile.posY, currentProjectile.height, 
                currentAlien.posX, currentAlien.width, 
                currentAlien.posY, currentAlien.height)){
                    /*console.log("Pre-shot:");
                    console.log("Alien list: ", alienList);
                    console.log("Moving rows: ", alienMovementRows);*/

                    addScore(alienPoints);
                    //console.log(alienAcceleratedFPS);

                    let currentPosX = currentAlien.posX;
                    let currentPosY = currentAlien.posY;
                    let currentColumn = currentAlien.column;
                    let currentRow = currentAlien.row;
                    alienList.splice(alienNo, 1);
                    //console.log("Removing alien no: ", alienNo);
                    removeProjectile = true;

                    //Update aliens in bottom to know which should keep shooting
                    let lowestAlien = null;
                    for(let i = 0; i < alienList.length; i++){
                        if(currentColumn == alienList[i].column){
                            if(lowestAlien == null){
                                lowestAlien = alienList[i];
                            }
                            else if(lowestAlien.row < alienList[i].row){
                                lowestAlien = alienList[i];
                            }
                        }
                    }

                    if(lowestAlien != null){
                        bottomAliens.push(lowestAlien);
                    }

                    bottomAliens = bottomAliens.filter(alien => !(alien.row == currentRow && alien.column == currentColumn));

                    //Update living rows for aliens
                    //If there aren't any aliens in the row, then remove the row from the movement queue and make index go down to one
                    let tempList = alienList.filter(alien => alien.row == currentRow);
                    //console.log("Living alien in row:", tempList);
                    if(tempList.length <= 0){
                        let indexToDelete = alienMovementRows.findIndex(row => currentRow == row);
                        alienMovementRows.splice(indexToDelete, 1);
                        if(indexToDelete <= alienCurrentMovementIndex){
                            alienCurrentMovementIndex--;
                            if(alienCurrentMovementIndex < 0){
                                alienCurrentMovementIndex = alienMovementRows.length - 1;
                            }
                        }
                    }

                    speedAliensUp();

                    //Create an explosion from the aliens!
                    //Get the center of the alien and draw it there! Since it is the same size as the alien, just use their same position and measures
                    addTempSprite(imgAlienExplosion, tempSpriteEnemyExplosionDuration, currentPosX, currentPosY, tempSpriteEnemyExplosionWidth, tempSpriteEnemyExplosionHeight);
                    playerProjectileCurrentReload = playerProjectileReloadTime;

                    /*console.log("Post-shot:");
                    console.log("Alien list: ", alienList);
                    console.log("Moving rows: ", alienMovementRows);*/

                    break;
                }
            }

            if(removeProjectile){
                playerProjectileList.splice(projectileNo, 1);
                projectileNo--;
                continue;
            }


            //Check if projectile hits UFO
            for(let UFONo = 0; UFONo < UFOList.length; UFONo++){
                let currentUFO = UFOList[UFONo];

                if(checkCollision(currentProjectile.posX, currentProjectile.width, 
                currentProjectile.posY, currentProjectile.height, 
                currentUFO.posX, currentUFO.width, 
                currentUFO.posY, currentUFO.height)){

                        //Give random points after hitting!
                        addScore(Math.floor(Math.random() * 6) * 50 + 50); //Score generated should be from 50 to 300
                        
                        //Remove UFO
                        UFOList.splice(UFONo, 1);

                        removeProjectile = true;

                        //Because the projectile is destroyed, stop iterating what it could hit
                        break;
                }
            }

            if(removeProjectile){
                playerProjectileList.splice(projectileNo, 1);
                projectileNo--;
                continue;
            }

            //Check if projectile hits enemy projectile
            for(let enemyProjectileNo = 0; enemyProjectileNo < enemyProjectileList.length; enemyProjectileNo++){
                let current = enemyProjectileList[enemyProjectileNo];

                if(checkCollision(currentProjectile.posX, currentProjectile.width, 
                currentProjectile.posY, currentProjectile.height, 
                current.posX, current.width, 
                current.posY, current.height)){

                        enemyProjectileList.splice(enemyProjectileNo, 1);
                        removeProjectile = true;
                        break;
                }
            }

            if(removeProjectile){
                playerProjectileList.splice(projectileNo, 1);
                projectileNo--;
                continue;
            }

            //Projectile reaches end of screen
            if(currentProjectile.posY <= playerProjectileYLimit){
                playerProjectileList.splice(projectileNo, 1);
                projectileNo--;
            }

        }

        //Check collision of enemy projectile
        for(let projectileNo = 0; projectileNo < enemyProjectileList.length; projectileNo++){
            let removeProjectile = false;

            let currentProjectile = enemyProjectileList[projectileNo];

            //Check if projectile hits shield

            for(let shieldNo = 0; shieldNo < shieldList.length; shieldNo++){
                let currentShield = shieldList[shieldNo];

                if(checkCollision(currentProjectile.posX, currentProjectile.width, 
                currentProjectile.posY, currentProjectile.height, 
                currentShield.posX, currentShield.width, 
                currentShield.posY, currentShield.height)){
                        currentShield.health--;

                        if(currentShield.health <= 0){
                            shieldList.splice(shieldNo, 1);
                            //Creo que no se ocupa al ser destruido el proyectil
                            //shieldNo--;
                        }

                        removeProjectile = true;
                        break;
                }

            }

            if(removeProjectile){
                enemyProjectileList.splice(projectileNo, 1);
                projectileNo--;
                continue;
            }

            //Check if projectile hits player
            if(checkCollision(currentProjectile.posX, currentProjectile.width,
            currentProjectile.posY, currentProjectile.height,
            playerPosX, playerWidth, playerPosY, playerHeight)){
                //TODO Activate game over check and all that
                lives--;
                removeProjectile = true;
            }

            if(removeProjectile){
                enemyProjectileList.splice(projectileNo, 1);
                projectileNo--;
                continue;
            }

            //Projectile reaches end of screen
            if(currentProjectile.posY >= 550){
                enemyProjectileList.splice(projectileNo, 1);
                projectileNo--;
            }
        }

        //Pass time for temporal sprites
        for(let spriteNo = 0; spriteNo < tempSpriteList.length; spriteNo++){
            let currentSprite = tempSpriteList[spriteNo];
            currentSprite.frames--;

            if(currentSprite.frames <= 0){
                tempSpriteList.splice(spriteNo, 1);
                spriteNo--;
            }
        }
    };

    var drawItems = () => {
        ctx.fillStyle = "black";
        ctx.fillRect(0, 0, gameCanvas.width, gameCanvas.height);
        
        //Draw score
        ctx.font = "30px Arial";
        ctx.fillStyle = "#ffffff";
        txtScore = "Score: " + score;
        ctx.fillText(txtScore, 10, 30);

        txtHighscore = "Hi-Score: " + highScore;
        ctx.fillText(txtHighscore, 300, 30);

        //Draw aliens
        let alienLength = alienList.length;
        for(let alienNo = 0; alienNo < alienLength; alienNo++){
            //console.log("Gone through alien no: ", alienNo);
            let currentAlien = alienList[alienNo];
            //console.log(currentAlien);
            ctx.drawImage(imgAlien, currentAlien.posX, currentAlien.posY, currentAlien.width, currentAlien.height);
        }

        //Draw UFO
        let UFOLength = UFOList.length;
        for(let UFONo = 0; UFONo < UFOLength; UFONo++){
            let currentUFO = UFOList[UFONo];
            ctx.drawImage(imgUFO, currentUFO.posX, currentUFO.posY, currentUFO.width, currentUFO.height);
        }

        //Draw shields
        let shieldLength = shieldList.length;
        for(let shieldNo = 0; shieldNo < shieldLength; shieldNo++){
            let currentShield = shieldList[shieldNo];
            ctx.drawImage(imgShield, currentShield.posX, currentShield.posY, currentShield.width, currentShield.height);
        }

        //Draw player
        ctx.drawImage(imgDefender, playerPosX, playerPosY, playerWidth, playerHeight);

        //Draw friendly projectiles
        let listLength = playerProjectileList.length;
        for(let i = 0; i < listLength; i++){
            let current = playerProjectileList[i];
            ctx.drawImage(imgProjectile, current.posX, current.posY, current.width, current.height);
        }

        //Draw enemy projectiles
        listLength = enemyProjectileList.length;
        for(let i = 0; i < listLength; i++){
            let current = enemyProjectileList[i];
            ctx.drawImage(imgEnemyProjectile, current.posX, current.posY, current.width, current.height);
        }

        //Draw temp sprites
        listLength = tempSpriteList.length;
        for(let i = 0; i < listLength; i++){
            let current = tempSpriteList[i];
            ctx.drawImage(current.image, current.posX, current.posY, current.width, current.height);
        }

        //Draw lives
        ctx.font = "20px Arial";
        ctx.fillText(lives, 10, 590);
        let initialXDrawingPos = 50;
        for(let i = 1; i < lives; i++){
            ctx.drawImage(imgDefender, (35*i), 575, 30, 15)
        }
        ctx.fillStyle = "#00FF00"
        ctx.fillRect(0, 565, 800, 3);
    }

    var restartGame = () => {
        //console.log("Restarted");
        
        if(gameInterval != null){
            clearInterval(gameInterval);
        }

        document.removeEventListener('keydown', handleKeyDown);
        document.removeEventListener('keyup', handleKeyUp);
        //gameStarted = 1;

        //Prepare score
        score = 0;

        //Prepare lives
        lives = defaultLives;

        //Add aliens to game
        alienList = [];
        alienMovementRows = [];
        alienCurrentMovementIndex = alienRows - 1;
        let initialX = 400 - ((alienColumns * alienWidth + alienXSeparation * (alienColumns - 1)) / 2);        
        let initialY = alienYStart;
        let currentY = initialY;

        //Create alien rows
        for(let row = 0; row < alienRows; row++){
            alienMovementRows.push(row);

            let currentX = initialX;

            for(let column = 0; column < alienColumns; column++){

                let alien = {
                    row: row,
                    column: column,
                    posX: currentX,
                    posY: currentY,
                    width: alienWidth,
                    height: alienHeight
                };

                alienList.push(alien);

                currentX += alienXSeparation + alienWidth;

                if(row == alienRows - 1){
                    bottomAliens.push(alien);
                    //console.log("Bottom Aliens:", bottomAliens);
                }
            }

            currentY += alienYSeparation + alienHeight;
        }

        //Add player
        playerPosX = playerInitialPosX;
        playerPosY = playerInitialPosY;

        //Add shields
        shieldList = [];
        let currentX = 0;
        let halfShieldSeparation = (800 - defaultShields * defaultShieldWidth) / (defaultShields + 1);
        for(let shieldNo = 0; shieldNo < defaultShields; shieldNo++){
            currentX += halfShieldSeparation;

            let shield = {
                width: defaultShieldWidth,
                height: defaultShieldHeight,
                posX: currentX,
                posY: defaultShieldPosY,
                health: defaultShieldHealth
            };

            currentX += defaultShieldWidth;

            shieldList.push(shield);
        }

        tempSpriteList = [];

        gameInterval = setInterval(gameLoop, timeFraction);

        document.addEventListener('keydown', handleKeyDown);
        document.addEventListener('keyup', handleKeyUp);
    }

    var handleKeyDown = () =>{
        if(event.keyCode == 37 && keyLeft == false) {
            keyLeft = true;
            //console.log('Left was pressed');
        }
        else if(event.keyCode == 39 && keyRight == false) {
            keyRight = true;
            //console.log('Right was pressed');
        }
        else if(event.keyCode == 65 && keyShoot == false) {
            keyShoot = true;
            //console.log('A was pressed');
        }
    }

    var handleKeyUp = () => {
        if(event.keyCode == 37 && keyLeft == true) {
            keyLeft = false;
            //console.log('Left was released');
        }
        else if(event.keyCode == 39 && keyRight == true) {
            keyRight = false;
            //console.log('Right was released');
        }
        else if(event.keyCode == 65 && keyShoot == true) {
            keyShoot = false;
            //console.log('A was pressed');
        }
    }

    var addScore = (points) => {
        score += points;

        if(score > highScore){
            highScore = score;
        }
    }

    //This is used after the alien is destroyed
    var speedAliensUp = () => {
        let startingAliens = alienRows * alienColumns;
        let totalAliens = alienList.length;

        if(totalAliens % alienRows == 0){
            alienAcceleratedFPS *= alienReduceFPSWaitPercentage - Math.round(startingAliens / totalAliens) * 0.04;
        }

        if(totalAliens < alienColumns){
            //alienAcceleratedFPS *= alienReduceFPSWaitPercentage - (alienColumns / totalAliens) * 0.1;
            alienAcceleratedFPS = (totalAliens/alienColumns) * 1;
        }
        else{
            alienAcceleratedFPS *= alienReduceFPSWaitPercentage;
        }

        /*if(totalAliens == 2){
            alienAcceleratedFPS = 0.1;
        }

        if(totalAliens == 1){
            alienAcceleratedFPS = 0;
        }*/

        if(alienAcceleratedFPS <= 0){
            alienAcceleratedFPS = 0;
        }
    }

    var checkCollision = (x1, width1, y1, height1, x2, width2, y2, height2) =>{
        return x1 + width1 > x2 && 
            x2 + width2 > x1 && 
            y1 + height1 > y2 &&
            y2 + height2 > y1;
    }

    var addTempSprite = (img, frames, posX, posY, width, height) => {
        let sprite = {
            image: img,
            frames: frames,
            posX: posX,
            posY: posY,
            width: width,
            height: height
        };

        tempSpriteList.push(sprite);
    }
</script>